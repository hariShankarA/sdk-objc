syntax = "proto3";
package io.token.proto.bankapi;

import "google/api/annotations.proto";
import "security.proto";

message AuthorizeLinkAccountsRequest {
  string username = 1;
  string client_id = 2;
  repeated string accounts = 3;
}

message AuthorizeLinkAccountsResponse {
  string bank_id = 1;
  string bank_name = 2;
  repeated io.token.proto.common.security.SealedMessage account_link_payloads = 3;
}


////////////////////////////////////////////////////////////////////////////////////////////////////
// Hosted by existing web service, exposes API to initiate account linking.
//

service AccountLinkingService {
  rpc AuthorizeLinkAccounts (AuthorizeLinkAccountsRequest) returns (AuthorizeLinkAccountsResponse) {
    option (google.api.http) = {
        put: "/clients/{client_id}/link-accounts"
    };
  }

  rpc AuthorizeLinkAccountsGet (AuthorizeLinkAccountsRequest) returns (AuthorizeLinkAccountsResponse) {
    option (google.api.http) = {
        get: "/clients/{client_id}/link-accounts?username={username}&accounts={accounts}"
    };
  }
}
