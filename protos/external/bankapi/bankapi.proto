syntax = "proto3";
package io.token.proto.bankapi;

import "google/protobuf/any.proto";

import "money.proto";
import "transaction.proto";
import "transfer.proto";


////////////////////////////////////////////////////////////////////////////////////////////////////
// Transaction API
//

message TransferRequest {
  string token_transaction_id = 1;
  io.token.proto.common.money.Money amount = 2;
  io.token.proto.common.transfer.Transfer transfer = 3;
}

message TransferResponse {
  string bank_transaction_id = 1;
  io.token.proto.common.transaction.TransactionStatus status = 2;
  string status_description = 3;
}

message GetTransactionRequest {
  string account_number = 1;
  string bank_transaction_id = 2;
}

message GetTransactionResponse {
  io.token.proto.common.transaction.Transaction transaction = 1;
}

message GetTransactionsRequest {
  string account_number = 1;
  int32 offset = 2;
  int32 limit = 3;
}

message GetTransactionsResponse {
  repeated io.token.proto.common.transaction.Transaction transactions = 1;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// Account API
//

message GetBalanceRequest {
  string account_number = 1;
}

message GetBalanceResponse {
  io.token.proto.common.money.Money current = 1;
  io.token.proto.common.money.Money available = 2;
}

message StartLinkBankRequest {
  string alias = 1;
  string secret = 2;
  repeated string accounts = 3;
  google.protobuf.Any metadata = 4;
}

message StartLinkBankResponse {
  string account_link_payload = 1;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// Account API
//

message SetValueRequest {
  string key = 1;
  google.protobuf.Any value = 2;
}

message SetValueResponse {
  google.protobuf.Any previous = 1;
}

message GetValueRequest {
  string key = 1;
}

message GetValueResponse {
  google.protobuf.Any value = 1;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// Bank API Services
//

service TransactionService {
  rpc Transfer (TransferRequest) returns (TransferResponse) {}
  rpc GetTransaction (GetTransactionRequest) returns (GetTransactionResponse) {}
  rpc GetTransactions (GetTransactionsRequest) returns (GetTransactionsResponse) {}
}

service AccountService {
  rpc StartLinkBank (StartLinkBankRequest) returns (StartLinkBankResponse) {}
  rpc GetBalance (GetBalanceRequest) returns (GetBalanceResponse) {}
}

service StorageService {
  rpc SetValue (SetValueRequest) returns (SetValueResponse) {}
  rpc GetValue (GetValueRequest) returns (GetValueResponse) {}
}
